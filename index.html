<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard con Video de Fondo, Reloj y 4 Iframes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        /* Estilo para el body y html para ocupar toda la altura */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Evita scroll general */
            /* background-color: #f3f4f6; */ /* Eliminado para ver el video */
            font-family: 'Inter', sans-serif; /* Fuente Inter */
            position: relative; /* Necesario para el z-index del contenido */
        }

        /* Estilos para el video de fondo */
        #background-video {
            position: fixed; /* Fijo en la ventana */
            right: 0;
            bottom: 0;
            min-width: 100%; /* Asegura que cubra todo el ancho */
            min-height: 100%; /* Asegura que cubra todo el alto */
            width: auto; /* Mantiene proporción */
            height: auto; /* Mantiene proporción */
            z-index: -100; /* Detrás de todo el contenido */
            object-fit: cover; /* Cubre el área sin distorsión */
            /* background: #f3f4f6 url('placeholder.jpg') no-repeat center center/cover; */ /* Opcional: Imagen de fallback */
        }

        /* Contenedor principal que divide la pantalla 20/80 */
        .main-layout {
            display: flex;
            flex-direction: column;
            height: 100vh; /* Ocupa toda la altura de la ventana */
            position: relative; /* Para asegurar que esté sobre el video */
            z-index: 1; /* Encima del video */
            /* background-color: rgba(243, 244, 246, 0.5); */ /* Fondo semi-transparente opcional */
        }
        /* Contenedor superior (Reloj/Alarma) - 20% */
        .top-section {
            flex: 0 0 20%; /* No crece, no encoge, base 20% */
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0.5rem 1rem; /* Padding ajustado */
            overflow: hidden; /* Oculta cualquier desbordamiento */
            /* border-bottom: 1px solid #e5e7eb; */ /* Quitada para mejor integración con fondo */
             background-color: rgba(255, 255, 255, 0.8); /* Fondo blanco semi-transparente */
             backdrop-filter: blur(5px); /* Efecto blur opcional */
             border-bottom: 1px solid rgba(229, 231, 235, 0.5); /* Borde semi-transparente */
        }
        /* Contenedor del Reloj y Alarma (dentro de top-section) */
        .clock-container {
            text-align: center;
            /* background-color: white; */ /* Hecho transparente */
            padding: 0.5rem 1rem; /* Padding ajustado */
            border-radius: 10px;
            /* box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); */ /* Sombra quitada */
            width: 100%;
            max-height: 100%;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        /* Contenedor para Fecha y Hora */
        .time-display {
             margin-bottom: 0.5rem;
             display: flex;
             justify-content: space-between;
             align-items: center;
             width: 100%;
             color: #1f2937; /* Color de texto más oscuro para contraste */
        }
        /* Fecha y Hora */
        #fecha, #hora {
            font-size: 1.5rem;
            /* color: #374151; */ /* Color heredado de .time-display */
            font-weight: 500;
            line-height: 1.2;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1); /* Sombra de texto ligera */
        }
        /* Sección de la Alarma */
        .alarm-section {
            padding-top: 0.5rem;
            border-top: 1px solid rgba(209, 213, 219, 0.6); /* Borde semi-transparente */
            width: 100%;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
        }
        /* Input de tiempo */
        input[type="time"] {
            padding: 0.3rem 0.4rem;
            border: 1px solid #d1d5db;
            border-radius: 5px;
            font-size: 0.8rem;
            background-color: rgba(255, 255, 255, 0.8); /* Fondo ligero */
        }
        /* Botones */
        button {
            padding: 0.4rem 0.7rem;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
            font-size: 0.8rem;
            white-space: nowrap;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1); /* Sombra ligera en botones */
        }
        .btn-set { background-color: #3b82f6; color: white; border: none; }
        .btn-set:hover { background-color: #2563eb; }
        .btn-clear { background-color: #ef4444; color: white; border: none; }
        .btn-clear:hover { background-color: #dc2626; }
        /* Estado de la alarma */
        #alarm-status {
            color: #374151; /* Color más oscuro */
            font-size: 0.75rem;
            min-height: 1em;
            text-align: center;
            width: 100%;
            order: 3;
            text-shadow: 0 1px 1px rgba(255,255,255,0.5); /* Sombra clara */
        }

        /* Contenedor inferior (Iframes) - 80% */
        .bottom-section {
            flex: 1 1 80%;
            display: grid;
            grid-template-columns: 1fr; /* Móvil: 1 columna */
            grid-template-rows: repeat(4, 1fr); /* Móvil: 4 filas */
            gap: 0.5rem;
            padding: 0.5rem;
            overflow: hidden; /* Oculta el desbordamiento */
        }

        /* En pantallas medianas y más grandes, cuadrícula 2x2 */
        @media (min-width: 768px) { /* md breakpoint */
            .bottom-section {
                grid-template-columns: repeat(2, 1fr); /* 2 columnas */
                grid-template-rows: repeat(2, 1fr);    /* 2 filas */
                gap: 1rem;
                padding: 1rem;
            }
            #fecha, #hora { font-size: 1.8rem; }
            button, input[type="time"], #alarm-status { font-size: 0.85rem; }
        }

        /* Contenedor individual de cada Iframe */
        .iframe-container {
            width: 100%;
            height: 100%;
            border-radius: 8px;
            overflow: hidden;
            background-color: rgba(229, 231, 235, 0.7); /* Fondo semi-transparente */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Sombra para destacar */
        }

        /* Iframe responsivo */
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }

        /* --- Estilos para el Modal de Alarma --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6); /* Más oscuro */
            display: flex;
            justify-content: center; align-items: center; z-index: 1000;
            opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease;
            backdrop-filter: blur(3px); /* Efecto blur en el fondo del modal */
        }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal-content {
            background-color: rgba(255, 255, 255, 0.95); /* Ligeramente transparente */
            padding: 1.5rem; border-radius: 8px;
            text-align: center; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            max-width: 90%;
        }
        .modal-content h2 { font-size: 1.3rem; margin-bottom: 0.8rem; color: #1f2937; }
        .modal-content p { margin-bottom: 1rem; color: #4b5563; font-size: 0.9rem;}
        .modal-close-btn { background-color: #6b7280; color: white; padding: 0.5rem 0.9rem; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: 0.9rem; border: none;}
        .modal-close-btn:hover { background-color: #4b5563; }
        /* --- Fin Estilos Modal --- */
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>

    <video autoplay muted loop playsinline id="background-video">
        <source src="https://raw.githubusercontent.com/mtoselli81/marcostoselli/main/Video_de_Flujo_Digital_Generado.mp4" type="video/mp4">
        Tu navegador no soporta videos HTML5.
    </video>

    <div class="main-layout">

        <div class="top-section">
            <div class="clock-container">
                <div class="time-display">
                    <div id="fecha">Cargando fecha...</div>
                    <div id="hora">Cargando hora...</div>
                </div>
                <div class="alarm-section">
                    <label for="alarm-time" class="sr-only">Hora de la alarma:</label>
                    <input type="time" id="alarm-time">
                    <button id="set-alarm-btn" class="btn-set">Establecer</button>
                    <button id="clear-alarm-btn" class="btn-clear">Limpiar</button>
                    <div id="alarm-status">No hay alarma establecida</div>
                </div>
            </div>
        </div>

        <div class="bottom-section">
            <div class="iframe-container">
                 <iframe src="https://www.youtube.com/embed/cb12KmMMDJA?si=5cqXI5biMq0Zu2Nk" title="YouTube video player 1" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
            <div class="iframe-container">
                 <iframe src="https://www.youtube.com/embed/OR9MH16MKrg?si=WtWP--O0_ab1z1-9" title="YouTube video player 2" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
            <div class="iframe-container">
                 <iframe src="https://www.youtube.com/embed/avly0uwZzOE?si=PQO2NtAxXUv7IYd9" title="YouTube video player 3" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
            <div class="iframe-container">
                 <iframe src="https://www.youtube.com/embed/jTDk5CswBVk?si=PxM-u4r8DdC1cdam" title="YouTube video player 4" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
        </div>

    </div>

    <div id="alarm-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>¡Alarma!</h2>
            <p>¡Es la hora!</p>
            <button id="modal-close-btn" class="modal-close-btn">Cerrar</button>
        </div>
    </div>

    <script>
        // --- Todo el JavaScript anterior se mantiene igual ---
        // (Elementos del DOM, Variables de estado, Inicialización Tone.js,
        // Funciones del Reloj, Funciones de Alarma, Funciones Modal/Sonido,
        // Event Listeners, Inicialización)

        // Elementos del DOM
        const fechaEl = document.getElementById('fecha');
        const horaEl = document.getElementById('hora');
        const alarmTimeInput = document.getElementById('alarm-time');
        const setAlarmBtn = document.getElementById('set-alarm-btn');
        const clearAlarmBtn = document.getElementById('clear-alarm-btn');
        const alarmStatusEl = document.getElementById('alarm-status');
        const alarmModal = document.getElementById('alarm-modal');
        const modalCloseBtn = document.getElementById('modal-close-btn');

        // Variables de estado
        let alarmTime = null;
        let alarmIntervalId = null;
        let alarmTriggeredToday = false;

        // --- Inicialización de Tone.js ---
        let synth;
        let audioInitialized = false;

        async function initializeAudio() {
            if (!audioInitialized && Tone.context.state !== 'running') {
                try {
                    await Tone.start();
                    console.log("AudioContext iniciado.");
                    synth = new Tone.Synth().toDestination();
                    audioInitialized = true;
                } catch (e) {
                    console.error("Error al iniciar AudioContext:", e);
                    alarmStatusEl.textContent = "Error audio";
                }
            } else if (Tone.context.state === 'running' && !synth) {
                 console.log("AudioContext corriendo, creando synth.");
                 synth = new Tone.Synth().toDestination();
                 audioInitialized = true;
            }
        }
        document.body.addEventListener('pointerdown', initializeAudio, { once: true });

        // --- Funciones del Reloj ---
        function formatTwoDigits(num) {
            return String(num).padStart(2, '0');
        }

        function actualizarReloj() {
            const ahora = new Date();
            const dia = formatTwoDigits(ahora.getDate());
            const mes = formatTwoDigits(ahora.getMonth() + 1);
            const anio = String(ahora.getFullYear()).slice(-2);
            fechaEl.textContent = `${dia}/${mes}/${anio}`;
            const horas = formatTwoDigits(ahora.getHours());
            const minutos = formatTwoDigits(ahora.getMinutes());
            const segundos = formatTwoDigits(ahora.getSeconds());
            horaEl.textContent = `${horas}:${minutos}:${segundos}`;
            checkAlarm(horas, minutos);
        }

        // --- Funciones de la Alarma ---
        function checkAlarm(currentHours, currentMinutes) {
            if (alarmTime) {
                const currentTimeFormatted = `${currentHours}:${currentMinutes}`;
                if (currentTimeFormatted === alarmTime && !alarmTriggeredToday) {
                    triggerAlarm();
                    alarmTriggeredToday = true;
                } else if (currentTimeFormatted !== alarmTime) {
                     alarmTriggeredToday = false;
                }
            }
        }

        async function setAlarm() {
            await initializeAudio();
            if (alarmTimeInput.value) {
                alarmTime = alarmTimeInput.value;
                alarmStatusEl.textContent = `Alarma: ${alarmTime}`;
                alarmTimeInput.value = "";
                alarmTriggeredToday = false;
                console.log("Alarma establecida:", alarmTime);
            } else {
                console.warn("Intento de establecer alarma sin hora.");
                alarmStatusEl.textContent = "Selecciona hora";
                setTimeout(() => {
                   if (!alarmTime) alarmStatusEl.textContent = "No hay alarma";
                }, 3000);
            }
        }

        function clearAlarm() {
            alarmTime = null;
            alarmStatusEl.textContent = "No hay alarma";
            alarmTriggeredToday = false;
            alarmTimeInput.value = "";
            console.log("Alarma limpiada.");
            stopAlarmSound();
        }

        // --- Funciones del Modal y Sonido ---
        function triggerAlarm() {
            showAlarmModal();
            playAlarmSound();
        }

        function showAlarmModal() {
            alarmModal.classList.add('active');
        }

        function hideAlarmModal() {
            alarmModal.classList.remove('active');
            stopAlarmSound();
        }

        function playAlarmSound() {
            if (synth && audioInitialized && Tone.context.state === 'running') {
                try {
                    const now = Tone.now();
                    synth.triggerAttackRelease("C4", "8n", now);
                    synth.triggerAttackRelease("E4", "8n", now + 0.25);
                    synth.triggerAttackRelease("G4", "8n", now + 0.5);
                    console.log("Reproduciendo sonido...");
                } catch (e) { console.error("Error sonido:", e); }
            } else { console.warn("Audio no listo. Estado:", Tone.context.state); }
        }

        function stopAlarmSound() {
             if (synth && typeof synth.triggerRelease === 'function') {
                 try { synth.triggerRelease(); console.log("Sonido detenido."); }
                 catch(e) { console.error("Error detener sonido:", e); }
             }
        }

        // --- Event Listeners ---
        setAlarmBtn.addEventListener('click', setAlarm);
        clearAlarmBtn.addEventListener('click', clearAlarm);
        modalCloseBtn.addEventListener('click', hideAlarmModal);
        alarmModal.addEventListener('click', (event) => {
            if (event.target === alarmModal) { hideAlarmModal(); }
        });

        // --- Inicialización ---
        alarmIntervalId = setInterval(actualizarReloj, 1000);
        actualizarReloj();

    </script>

</body>
</html>
