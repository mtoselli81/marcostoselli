<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard con Reloj y 4 Iframes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        /* Estilo para el body y html para ocupar toda la altura */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Evita scroll general */
            background-color: #f3f4f6; /* Color de fondo gris claro */
            font-family: 'Inter', sans-serif; /* Fuente Inter */
        }
        /* Contenedor principal que divide la pantalla 20/80 */
        .main-layout {
            display: flex;
            flex-direction: column;
            height: 100vh; /* Ocupa toda la altura de la ventana */
        }
        /* Contenedor superior (Reloj/Alarma) - 20% */
        .top-section {
            flex: 0 0 20%; /* No crece, no encoge, base 20% */
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0.5rem 1rem; /* Padding ajustado */
            overflow: hidden; /* Oculta cualquier desbordamiento */
            border-bottom: 1px solid #e5e7eb; /* Línea divisoria opcional */
        }
        /* Contenedor del Reloj y Alarma (dentro de top-section) */
        .clock-container {
            text-align: center;
            background-color: white;
            padding: 0.5rem 1rem; /* Padding ajustado */
            border-radius: 10px; /* Bordes ligeramente menos redondeados */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); /* Sombra más sutil */
            width: 100%; /* Ocupa todo el ancho de top-section */
            max-height: 100%; /* Asegura que no exceda el 20% */
            overflow: hidden; /* Evita scroll interno */
            display: flex; /* Usa flexbox para alinear elementos */
            flex-direction: column; /* Apila elementos verticalmente */
            justify-content: center; /* Centra verticalmente el contenido */
        }
        /* Contenedor para Fecha y Hora */
        .time-display {
             margin-bottom: 0.5rem; /* Espacio antes de la alarma */
             display: flex; /* Usa Flexbox */
             justify-content: space-between; /* Alinea fecha a la izq, hora a la der */
             align-items: center; /* Centra verticalmente */
             width: 100%; /* Ocupa todo el ancho del contenedor padre */
        }
        /* Fecha y Hora */
        #fecha, #hora {
            font-size: 1.5rem; /* Tamaño reducido */
            color: #374151;
            /* margin: 0.1rem 0; */ /* Eliminado, el espaciado lo maneja flex */
            font-weight: 500;
            line-height: 1.2; /* Reduce altura de línea */
        }
        /* Sección de la Alarma */
        .alarm-section {
            padding-top: 0.5rem;
            border-top: 1px solid #e5e7eb;
            width: 100%; /* Asegura que ocupe el ancho */
            display: flex; /* Flex para alinear controles de alarma */
            flex-wrap: wrap; /* Permite que los elementos pasen a la siguiente línea si no caben */
            justify-content: center; /* Centra los elementos */
            align-items: center; /* Alinea verticalmente */
            gap: 0.5rem; /* Espacio entre elementos */
        }
        /* Input de tiempo */
        input[type="time"] {
            padding: 0.3rem 0.4rem; /* Padding reducido */
            border: 1px solid #d1d5db;
            border-radius: 5px;
            font-size: 0.8rem; /* Tamaño fuente reducido */
        }
        /* Botones */
        button {
            padding: 0.4rem 0.7rem; /* Padding reducido */
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
            font-size: 0.8rem; /* Tamaño fuente reducido */
            white-space: nowrap; /* Evita que el texto del botón se divida */
        }
        .btn-set { background-color: #3b82f6; color: white; }
        .btn-set:hover { background-color: #2563eb; }
        .btn-clear { background-color: #ef4444; color: white; }
        .btn-clear:hover { background-color: #dc2626; }
        /* Estado de la alarma */
        #alarm-status {
            color: #6b7280;
            font-size: 0.75rem; /* Tamaño fuente muy reducido */
            min-height: 1em; /* Altura mínima */
            text-align: center; /* Centrado */
            width: 100%; /* Ocupa ancho para centrar bien */
            order: 3; /* Asegura que aparezca después de los botones en el flex wrap */
        }

        /* Contenedor inferior (Iframes) - 80% */
        .bottom-section {
            flex: 1 1 80%; /* Crece y encoge, base 80% */
            display: grid;
            grid-template-columns: 1fr; /* Móvil: 1 columna */
            grid-template-rows: repeat(4, 1fr); /* Móvil: 4 filas */
            gap: 0.5rem; /* Espacio reducido entre iframes */
            padding: 0.5rem; /* Padding reducido */
            overflow: hidden; /* Oculta el desbordamiento */
        }

        /* En pantallas medianas y más grandes, cuadrícula 2x2 */
        @media (min-width: 768px) { /* md breakpoint */
            .bottom-section {
                grid-template-columns: repeat(2, 1fr); /* 2 columnas */
                grid-template-rows: repeat(2, 1fr);    /* 2 filas */
                gap: 1rem; /* Restaura gap para desktop */
                padding: 1rem; /* Restaura padding para desktop */
            }
            #fecha, #hora { font-size: 1.8rem; } /* Restaura tamaño fuente reloj en desktop */
            button, input[type="time"], #alarm-status { font-size: 0.85rem; } /* Ligeramente más grande en desktop */
        }

        /* Contenedor individual de cada Iframe */
        .iframe-container {
            width: 100%;
            height: 100%;
            border-radius: 8px;
            overflow: hidden;
            background-color: #e5e7eb;
        }

        /* Iframe responsivo */
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }

        /* --- Estilos para el Modal de Alarma --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.5); display: flex;
            justify-content: center; align-items: center; z-index: 1000;
            opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal-content {
            background-color: white; padding: 1.5rem; border-radius: 8px; /* Padding reducido */
            text-align: center; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            max-width: 90%;
        }
        .modal-content h2 { font-size: 1.3rem; margin-bottom: 0.8rem; color: #1f2937; } /* Tamaño reducido */
        .modal-content p { margin-bottom: 1rem; color: #4b5563; font-size: 0.9rem;} /* Tamaño reducido */
        .modal-close-btn { background-color: #6b7280; color: white; padding: 0.5rem 0.9rem; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: 0.9rem;} /* Tamaño reducido */
        .modal-close-btn:hover { background-color: #4b5563; }
        /* --- Fin Estilos Modal --- */
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>

    <div class="main-layout">

        <div class="top-section">
            <div class="clock-container">
                <div class="time-display">
                    <div id="fecha">Cargando fecha...</div>
                    <div id="hora">Cargando hora...</div>
                </div>
                <div class="alarm-section">
                    <label for="alarm-time" class="sr-only">Hora de la alarma:</label>
                    <input type="time" id="alarm-time">
                    <button id="set-alarm-btn" class="btn-set">Establecer</button>
                    <button id="clear-alarm-btn" class="btn-clear">Limpiar</button>
                    <div id="alarm-status">No hay alarma establecida</div>
                </div>
            </div>
        </div>

        <div class="bottom-section">
            <div class="iframe-container">
                 <iframe src="https://www.youtube.com/embed/cb12KmMMDJA?si=5cqXI5biMq0Zu2Nk" title="YouTube video player 1" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
            <div class="iframe-container">
                 <iframe src="https://www.youtube.com/embed/OR9MH16MKrg?si=WtWP--O0_ab1z1-9" title="YouTube video player 2" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
            <div class="iframe-container">
                 <iframe src="https://www.youtube.com/embed/avly0uwZzOE?si=PQO2NtAxXUv7IYd9" title="YouTube video player 3" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
            <div class="iframe-container">
                 <iframe src="https://www.youtube.com/embed/jTDk5CswBVk?si=PxM-u4r8DdC1cdam" title="YouTube video player 4" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
        </div>

    </div>

    <div id="alarm-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>¡Alarma!</h2>
            <p>¡Es la hora!</p>
            <button id="modal-close-btn" class="modal-close-btn">Cerrar</button>
        </div>
    </div>

    <script>
        // Elementos del DOM
        const fechaEl = document.getElementById('fecha');
        const horaEl = document.getElementById('hora');
        const alarmTimeInput = document.getElementById('alarm-time');
        const setAlarmBtn = document.getElementById('set-alarm-btn');
        const clearAlarmBtn = document.getElementById('clear-alarm-btn');
        const alarmStatusEl = document.getElementById('alarm-status');
        const alarmModal = document.getElementById('alarm-modal');
        const modalCloseBtn = document.getElementById('modal-close-btn');

        // Variables de estado
        let alarmTime = null;
        let alarmIntervalId = null;
        let alarmTriggeredToday = false;

        // --- Inicialización de Tone.js ---
        let synth;
        let audioInitialized = false;

        async function initializeAudio() {
            if (!audioInitialized && Tone.context.state !== 'running') {
                try {
                    await Tone.start();
                    console.log("AudioContext iniciado.");
                    synth = new Tone.Synth().toDestination();
                    audioInitialized = true;
                } catch (e) {
                    console.error("Error al iniciar AudioContext:", e);
                    alarmStatusEl.textContent = "Error audio";
                }
            } else if (Tone.context.state === 'running' && !synth) {
                 console.log("AudioContext corriendo, creando synth.");
                 synth = new Tone.Synth().toDestination();
                 audioInitialized = true;
            }
        }
        document.body.addEventListener('pointerdown', initializeAudio, { once: true });

        // --- Funciones del Reloj ---
        function formatTwoDigits(num) {
            return String(num).padStart(2, '0');
        }

        function actualizarReloj() {
            const ahora = new Date();
            const dia = formatTwoDigits(ahora.getDate());
            const mes = formatTwoDigits(ahora.getMonth() + 1);
            const anio = String(ahora.getFullYear()).slice(-2);
            fechaEl.textContent = `${dia}/${mes}/${anio}`;
            const horas = formatTwoDigits(ahora.getHours());
            const minutos = formatTwoDigits(ahora.getMinutes());
            const segundos = formatTwoDigits(ahora.getSeconds());
            horaEl.textContent = `${horas}:${minutos}:${segundos}`;
            checkAlarm(horas, minutos);
        }

        // --- Funciones de la Alarma ---
        function checkAlarm(currentHours, currentMinutes) {
            if (alarmTime) {
                const currentTimeFormatted = `${currentHours}:${currentMinutes}`;
                if (currentTimeFormatted === alarmTime && !alarmTriggeredToday) {
                    triggerAlarm();
                    alarmTriggeredToday = true;
                } else if (currentTimeFormatted !== alarmTime) {
                     alarmTriggeredToday = false;
                }
            }
        }

        async function setAlarm() {
            await initializeAudio();
            if (alarmTimeInput.value) {
                alarmTime = alarmTimeInput.value;
                alarmStatusEl.textContent = `Alarma: ${alarmTime}`;
                alarmTimeInput.value = "";
                alarmTriggeredToday = false;
                console.log("Alarma establecida:", alarmTime);
            } else {
                console.warn("Intento de establecer alarma sin hora.");
                alarmStatusEl.textContent = "Selecciona hora";
                setTimeout(() => {
                   if (!alarmTime) alarmStatusEl.textContent = "No hay alarma";
                }, 3000);
            }
        }

        function clearAlarm() {
            alarmTime = null;
            alarmStatusEl.textContent = "No hay alarma";
            alarmTriggeredToday = false;
            alarmTimeInput.value = "";
            console.log("Alarma limpiada.");
            stopAlarmSound();
        }

        // --- Funciones del Modal y Sonido ---
        function triggerAlarm() {
            showAlarmModal();
            playAlarmSound();
        }

        function showAlarmModal() {
            alarmModal.classList.add('active');
        }

        function hideAlarmModal() {
            alarmModal.classList.remove('active');
            stopAlarmSound();
        }

        function playAlarmSound() {
            if (synth && audioInitialized && Tone.context.state === 'running') {
                try {
                    const now = Tone.now();
                    synth.triggerAttackRelease("C4", "8n", now);
                    synth.triggerAttackRelease("E4", "8n", now + 0.25);
                    synth.triggerAttackRelease("G4", "8n", now + 0.5);
                    console.log("Reproduciendo sonido...");
                } catch (e) { console.error("Error sonido:", e); }
            } else { console.warn("Audio no listo. Estado:", Tone.context.state); }
        }

        function stopAlarmSound() {
             if (synth && typeof synth.triggerRelease === 'function') {
                 try { synth.triggerRelease(); console.log("Sonido detenido."); }
                 catch(e) { console.error("Error detener sonido:", e); }
             }
        }

        // --- Event Listeners ---
        setAlarmBtn.addEventListener('click', setAlarm);
        clearAlarmBtn.addEventListener('click', clearAlarm);
        modalCloseBtn.addEventListener('click', hideAlarmModal);
        alarmModal.addEventListener('click', (event) => {
            if (event.target === alarmModal) { hideAlarmModal(); }
        });

        // --- Inicialización ---
        alarmIntervalId = setInterval(actualizarReloj, 1000);
        actualizarReloj();

    </script>

</body>
</html>
